SELECT e.EMPNO, e.ENAME, d.DNAME, d.DLOC
FROM EMPLOYEE e
JOIN DEPT d ON e.DEPTNO = d.DEPTNO;


SELECT e.EMPNO, e.ENAME
FROM EMPLOYEE e
LEFT JOIN ASSIGNED_TO a ON e.EMPNO = a.EMPNO
WHERE a.PNO IS NULL;
SELECT p.PNO, p.PNAME, COUNT(a.EMPNO) AS headcount
FROM PROJECT p
LEFT JOIN ASSIGNED_TO a ON p.PNO = a.PNO
GROUP BY p.PNO, p.PNAME;


SELECT d.DEPTNO, d.DNAME,
       AVG(e.SAL) AS avg_salary,
       MAX(e.SAL) AS max_salary
FROM DEPT d
LEFT JOIN EMPLOYEE e ON d.DEPTNO = e.DEPTNO
GROUP BY d.DEPTNO, d.DNAME;


SELECT e.EMPNO, e.ENAME,
       COALESCE(SUM(i.INCENTIVE_AMOUNT), 0) AS total_incentives
FROM EMPLOYEE e
LEFT JOIN INCENTIVES i ON e.EMPNO = i.EMPNO
GROUP BY e.EMPNO, e.ENAME
ORDER BY total_incentives DESC;


SELECT e.EMPNO, e.ENAME
FROM EMPLOYEE e
JOIN ASSIGNED_TO a ON e.EMPNO = a.EMPNO
JOIN PROJECT p ON a.PNO = p.PNO
WHERE p.PNAME = 'AlphaPlatform';


SELECT d.DEPTNO, d.DNAME
FROM DEPT d
LEFT JOIN EMPLOYEE e ON d.DEPTNO = e.DEPTNO
WHERE e.EMPNO IS NULL;


SELECT m.EMPNO AS manager_id,
       m.ENAME AS manager_name,
       COUNT(e.EMPNO) AS direct_reports
FROM EMPLOYEE m
LEFT JOIN EMPLOYEE e ON e.MGR_NO = m.EMPNO
GROUP BY m.EMPNO, m.ENAME;


SELECT e.EMPNO, e.ENAME, COUNT(a.PNO) AS project_count
FROM EMPLOYEE e
JOIN ASSIGNED_TO a ON e.EMPNO = a.EMPNO
GROUP BY e.EMPNO, e.ENAME
HAVING COUNT(a.PNO) > 1;
